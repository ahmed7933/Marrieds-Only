<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hot Night ğŸ”¥ | Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    
    <link rel="preload" as="image" href="images/hero-img.webp">
    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>

    <style>
        :root { --primary: #d4af37; --accent: #e50914; --blue: #00bfff; --purple: #8a2be2; --pink: #ff00cc; --green: #2ecc71; --bg: #050505; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; outline: none; }
        body {
            margin: 0; background-color: var(--bg);
            background-image: radial-gradient(circle at 50% 50%, #150505 0%, #000 90%);
            font-family: 'Cairo', sans-serif; color: white;
            height: 100vh; height: 100dvh; overflow: hidden; display: flex; justify-content: center; align-items: center;
        }

        /* --- Screens & Layout --- */
        .screen { display: none; width: 100%; height: 100%; max-height: 100dvh; position: relative; z-index: 2; flex-direction: column; align-items: center; padding: 15px; overflow-y: auto; opacity: 0; transition: opacity 0.3s ease-in; }
        .screen.active { display: flex; opacity: 1; }
        .top-nav { width: 100%; max-width: 500px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 0 5px; height: 40px; flex-shrink: 0; }
        .nav-title { font-size: 1.1rem; font-weight: 800; color: var(--primary); margin: 0; flex-grow: 1; text-align: center; }
        .exit-btn { background: rgba(255,255,255,0.1); border: 1px solid #444; color: #aaa; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; cursor: pointer; transition: 0.3s; flex-shrink: 0; }
        .dummy-space { width: 35px; }

        /* --- Landing & Pricing --- */
        .landing-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; height: 100%; overflow-y: auto; padding: 20px 10px; background: linear-gradient(to bottom, #000, #111); z-index: 50; }
        .pricing-card { background: rgba(255,255,255,0.05); border: 1px solid #333; padding: 20px; border-radius: 20px; margin: 10px 0; width: 100%; max-width: 350px; text-align: center; transition: 0.3s; position: relative; }
        .pricing-card.best { background: rgba(212, 175, 55, 0.08); border: 2px solid var(--primary); transform: scale(1.02); }
        .price-tag { font-size: 2.2rem; color: white; font-weight: 800; margin: 15px 0; font-family: 'Cairo'; }
        .features-list { list-style: none; padding: 0; color: #ccc; font-size: 0.9rem; margin-bottom: 25px; text-align: right; padding-right: 20px; }
        .features-list li { margin: 8px 0; display: flex; align-items: center; }
        .features-list li::before { content: "âœ“"; color: var(--primary); margin-left: 8px; font-weight: bold; }

        /* --- Login & Forms --- */
        .login-wrapper { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #050505; display: flex; justify-content: center; align-items: center; overflow: hidden; z-index: 1000; }
        .blob { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.6; animation: float 10s infinite alternate; }
        .blob-1 { width: 300px; height: 300px; background: #4a0000; top: -50px; left: -50px; }
        .blob-2 { width: 250px; height: 250px; background: #5c4500; bottom: -50px; right: -50px; animation-delay: -5s; }
        .login-card-pro { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); padding: 50px 30px; border-radius: 30px; width: 90%; max-width: 380px; text-align: center; box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5); position: relative; z-index: 2; transform: translateY(20px); animation: slideUp 0.8s forwards ease-out; }
        .logo-pro { font-size: 2.5rem; font-weight: 900; margin-bottom: 10px; background: linear-gradient(135deg, #fff 0%, #d4af37 50%, #b8860b 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.3)); }
        .subtitle-pro { color: #aaa; font-size: 0.9rem; margin-bottom: 40px; }
        .input-pro, .input-field { width: 100%; background: rgba(0, 0, 0, 0.3); border: 2px solid #333; padding: 15px; border-radius: 15px; color: #fff; text-align: center; font-size: 1.1rem; transition: 0.3s; margin-bottom: 15px; font-family: 'Cairo'; }
        .input-pro:focus, .input-field:focus { border-color: var(--primary); background: rgba(0, 0, 0, 0.5); }
        .btn-pro, .btn-gold { background: linear-gradient(90deg, #d4af37, #f7ef8a, #d4af37); background-size: 200%; color: #000; font-weight: 900; padding: 15px; width: 100%; border-radius: 15px; border: none; font-size: 1rem; cursor: pointer; transition: 0.3s; box-shadow: 0 5px 20px rgba(212, 175, 55, 0.3); position: relative; overflow: hidden; animation: shine 4s infinite linear; }
        .error-msg { color: #ff4d4d; margin-top: 15px; font-size: 0.9rem; display: none; background: rgba(255,0,0,0.1); padding: 5px; border-radius: 5px; }

        /* --- Modals --- */
        .modal-glass { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 100; display: none; justify-content: center; align-items: center; flex-direction: column; padding: 20px; backdrop-filter: blur(5px); }
        .modal-glass.show { display: flex; animation: fadeIn 0.3s; }
        .guide-content, .instr-content { background: #151515; border: 1px solid var(--primary); border-radius: 20px; width: 100%; max-width: 400px; padding: 25px; text-align: right; max-height: 85vh; overflow-y: auto; }
        .step-box { background: rgba(255,255,255,0.05); border-right: 3px solid var(--primary); padding: 12px; margin-bottom: 12px; border-radius: 8px; }
        .hero-banner-container { width: 100%; max-height: 180px; margin-bottom: 20px; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid rgba(212, 175, 55, 0.2); }
        .hero-img { width: 100%; height: 100%; object-fit: cover; }

        /* --- Games (General) --- */
        .games-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; width: 100%; max-width: 500px; padding-bottom: 20px; }
        .game-item { position: relative; aspect-ratio: 1 / 1; border-radius: 18px; overflow: hidden; cursor: pointer; border: 1px solid #333; }
        .game-item.full-width { grid-column: span 2; aspect-ratio: auto; height: 100px; }
        .game-item img { width: 100%; height: 100%; object-fit: cover; opacity: 0.8; }
        .game-label { position: absolute; bottom: 0; left: 0; width: 100%; padding: 10px; background: linear-gradient(to top, black, rgba(0,0,0,0.5)); text-align: center; }
        .g-title { font-size: 1rem; font-weight: 800; color: white; margin-bottom: 2px; } .g-sub { font-size: 0.7rem; color: var(--primary); font-weight: bold; }

        /* --- Specific Game Styles (Card, Elimination, Catch, Wheel) --- */
        .card-stage { perspective: 1000px; width: 100%; max-width: 320px; height: 320px; margin: 20px auto; display: flex; align-items: center; justify-content: center; }
        .flipper { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; transition: 0.6s; }
        .front, .back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; text-align: center; border: 2px solid var(--primary); box-shadow: 0 15px 40px rgba(0,0,0,0.6); }
        .front { background: #111 url('https://www.transparenttextures.com/patterns/carbon-fibre.png'); }
        .back { background: #151515; transform: rotateY(180deg); }
        .flipped { transform: rotateY(180deg); }
        .text-content { font-size: 1.35rem; font-weight: bold; color: #fff; }
        
        .elimination-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; width: 100%; max-width: 340px; margin: 15px auto; padding: 0 5px; }
        .place-card { aspect-ratio: 1 / 1; border-radius: 12px; background: #222; border: 1px solid var(--primary); display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; transition: 0.2s; padding: 5px; }
        .place-card.eliminated { background: #111; opacity: 0.3; transform: scale(0.95); filter: grayscale(100%); }
        .place-card.winner { background: var(--primary); transform: scale(1.05); z-index: 10; } .place-card.winner .place-name { color: black; }
        
        .board-container { flex-grow: 0; height: auto; overflow-y: hidden; padding: 5px; display: flex; flex-direction: column-reverse; align-items: center; justify-content: center; gap: 3px; width: 100%; background-image: radial-gradient(#222 1px, transparent 1px); background-size: 15px 15px; margin-bottom: 5px; border-radius: 15px; border: 1px solid #333; }
        .row { display: flex; gap: 3px; justify-content: center; width: 100%; }
        .square { width: 38px; height: 38px; border-radius: 6px; display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 0.8rem; position: relative; border: 1px solid rgba(255,255,255,0.1); }
        .blue-zone { background: linear-gradient(135deg, #00bfff, #0077be); } .purple-zone { background: linear-gradient(135deg, #8a2be2, #4b0082); } .pink-zone { background: linear-gradient(135deg, #ff00cc, #99007a); } .red-zone { background: linear-gradient(135deg, #ff0055, #990033); } .finish-zone { background: linear-gradient(135deg, var(--primary), #b8860b); color: black; }
        .player-token { width: 14px; height: 14px; border-radius: 50%; position: absolute; border: 1px solid white; box-shadow: 0 0 3px black; transition: all 0.5s ease; z-index: 5; }
        .p1-token { background: var(--primary); top: 1px; left: 1px; } .p2-token { background: white; bottom: 1px; right: 1px; }
        
        .wheel-container { width: 330px; height: 330px; position: relative; border-radius: 50%; border: 8px solid #222; box-shadow: 0 0 40px rgba(46, 204, 113, 0.3); overflow: hidden; margin: 0 auto; }
        .wheel-bg, .wheel-icons-layer { width: 100%; height: 100%; border-radius: 50%; position: absolute; top:0; left:0; transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99); }
        .icon-box { position: absolute; top: 50%; left: 50%; width: 0; height: 0; }
        .icon-content { position: absolute; left: -20px; bottom: 65px; width: 40px; text-align: center; font-size: 1.8rem; color: white; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5)); }
        .pointer { position: absolute; top: -20px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent; border-top: 45px solid #fff; z-index: 20; }
        .wheel-result-card, .catch-card { background: #111; border: 3px solid var(--green); padding: 25px; border-radius: 25px; text-align: center; width: 90%; max-width: 380px; box-shadow: 0 0 50px rgba(46, 204, 113, 0.2); }

        /* Animations */
        @keyframes shake { 0% { transform: rotate(0deg); } 25% { transform: rotate(10deg); } 75% { transform: rotate(-10deg); } 100% { transform: rotate(0deg); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes float { 0% { transform: translate(0, 0); } 100% { transform: translate(20px, 20px); } }
        @keyframes slideUp { to { opacity: 1; transform: translateY(0); } }
        @keyframes shine { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }
    </style>
</head>
<body>

    <div id="landing" class="screen landing-screen active">
        <div class="logo-pro" style="font-size: 3.5rem; margin-bottom: 0;">HOT NIGHT</div>
        <p style="color:#888; text-align:center; margin-bottom:30px; font-size: 0.9rem;">
            Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ù„Ù„Ù…ØªØ²ÙˆØ¬ÙŠÙ† ÙÙ‚Ø· +18 <br> 
            <span style="color:var(--primary)">Ø¬Ø¯Ø¯ Ø­ÙŠØ§ØªÙƒ Ø§Ù„Ø²ÙˆØ¬ÙŠØ© Ø¨Ù„Ù…Ø³Ø© ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§</span>
        </p>
        
        <div class="pricing-card">
            <h3 style="color:white; margin:0;">ØªØ¬Ø±Ø¨Ø© (Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯)</h3>
            <div class="price-tag">149 EGP</div>
            <button class="btn-gold" style="background: #333; color: white; border:1px solid #555;" onclick="openRegister(1)">Ø§Ø´ØªØ±Ø§Ùƒ</button>
        </div>
        
        <div class="pricing-card best">
            <div style="position:absolute; top:-12px; left:50%; transform:translateX(-50%); background:var(--primary); color:black; font-weight:bold; font-size:0.8rem; border-radius:20px; padding:4px 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.5);">Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹ ğŸ”¥</div>
            <h3 style="color:var(--primary); margin-top:10px;">Ø¨Ø§Ù‚Ø© Ø§Ù„ØªÙˆÙÙŠØ± (3 Ø´Ù‡ÙˆØ±)</h3>
            <ul class="features-list">
                <li>ÙØªØ­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ (9 Ø£Ù„Ø¹Ø§Ø¨)</li>
                <li>ØªÙØ¹ÙŠÙ„ Ù„Ø¬Ù‡Ø§Ø²ÙŠÙ† (Ø£Ù†Øª ÙˆØ´Ø±ÙŠÙƒÙƒ)</li>
                <li>ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨</li>
            </ul>
            <div class="price-tag">269 EGP</div>
            <button class="btn-gold" onclick="openRegister(3)">Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¢Ù†</button>
        </div>

        <div style="margin-top:40px; text-align: center;">
            <p style="color:#666; font-size: 0.8rem; margin-bottom: 5px;">Ù…Ø´ØªØ±Ùƒ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ</p>
            <button style="background:none; border:none; color:var(--primary); text-decoration: underline; cursor:pointer; font-size: 1rem;" onclick="show('login')">Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„ÙƒÙˆØ¯</button>
        </div>
    </div>

    <div id="register-modal" class="modal-glass">
        <div class="login-card-pro" style="animation: none; padding: 30px;">
            <h2 style="color:var(--primary); margin-top:0;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h2>
            <p style="color:#aaa; font-size:0.8rem; margin-bottom:20px;">Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ ÙˆØ§ØªØ³Ø§Ø¨ Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯</p>
            <input type="text" id="reg-name" class="input-field" placeholder="Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù„Ù‚Ø¨">
            <input type="tel" id="reg-phone" class="input-field" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ (01xxxxxxxxx)">
            <input type="hidden" id="reg-plan">
            <button class="btn-pro" onclick="submitRegistration()" id="reg-btn">ØªØ£ÙƒÙŠØ¯ ÙˆØ­Ø¬Ø²</button>
            <button style="background:none; border:none; color:#666; margin-top:15px; cursor:pointer; width:100%;" onclick="document.getElementById('register-modal').classList.remove('show'); setTimeout(()=>document.getElementById('register-modal').style.display='none', 300);">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <div id="modal-guide" class="modal-glass"></div>

    <div id="login" class="screen login-wrapper">
        <div class="blob blob-1"></div><div class="blob blob-2"></div>
        <div class="login-card-pro">
            <div class="hero-banner-container">
                <img src="images/hero-img.webp" onerror="this.style.display='none'" alt="Hot Night" class="hero-img">
            </div>
            <div class="logo-pro">HOT NIGHT</div>
            <p class="subtitle-pro">ØªØ¬Ø±Ø¨Ø© Ø²ÙˆØ¬ÙŠØ© ÙØ§Ø®Ø±Ø©<br><span style="color:var(--primary); font-size:0.8rem; opacity:0.8;">Premium Edition +18</span></p>
            <div class="input-group-pro"><input type="password" id="pass" class="input-pro" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„" autocomplete="off"></div>
            <button class="btn-pro" onclick="login()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø³Ù‡Ø±Ø© ğŸš€</button>
            <div id="error" class="error-msg">âš ï¸ Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­</div>
            <div style="margin-top: 30px; font-size: 0.7rem; color: #666;">By Ahmed Â© 2025 | Secure Login</div>
        </div>
    </div>

    <div id="dashboard" class="screen">
        <div class="dashboard-header">
            <div><h2 style="color:white; margin:0;">Ø¨Ø§Ù‚Ø© Ø§Ù„Ø³Ø¹Ø§Ø¯Ø© ğŸ”¥</h2><p style="color:var(--primary); font-size:0.8rem; margin:5px 0 0 0;">9 ØªØ¬Ø§Ø±Ø¨ Ù…Ø®ØªÙ„ÙØ©</p></div>
            <button class="guide-btn" onclick="openGuide()">Ø§Ù„Ø¯Ù„ÙŠÙ„ ğŸ—ºï¸</button>
        </div>
        <div class="games-grid">
            <div class="game-item" onclick="openInstructions('game1')"><img src="images/cover1.webp" onerror="this.src='images/cover1.png'" alt="1"><div class="game-label"><div class="g-title">1. Ø¶Ø­Ùƒ ÙˆØ¯Ù„Ø¹ ğŸ˜‚</div></div></div>
            <div class="game-item" onclick="openInstructions('game2')"><img src="images/cover2.webp" onerror="this.src='images/cover2.png'" alt="2"><div class="game-label"><div class="g-title">2. Ø­Ø¨ ÙˆÙ‚Ø±Ø¨ â¤ï¸</div></div></div>
            <div class="game-item" onclick="openInstructions('game3')"><img src="images/cover3.webp" onerror="this.src='images/cover3.png'" alt="3"><div class="game-label"><div class="g-title">3. Ø£Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø±ÙƒØ© âš”ï¸</div></div></div>
            <div class="game-item" onclick="openInstructions('game4')"><img src="images/cover4.webp" onerror="this.src='images/cover4.png'" alt="4"><div class="game-label"><div class="g-title">4. Ù‡Ù…Ø³ ÙˆÙ„Ù…Ø³ ğŸ”¥</div></div></div>
            <div class="game-item" onclick="openInstructions('game5')"><img src="images/cover5.webp" onerror="this.src='images/cover5.png'" alt="5"><div class="game-label"><div class="g-title">5. Ù†Ø§Ø± ÙˆØ¯Ù…Ø§Ø± ğŸ”</div></div></div>
            <div class="game-item" onclick="openInstructions('game6')"><img src="images/cover6.webp" onerror="this.src='images/cover6.png'" alt="6"><div class="game-label"><div class="g-title">6. ØªÙ…Ø«ÙŠÙ„ Ø³Ø§Ø®Ù† ğŸ­</div></div></div>
            <div class="game-item" onclick="openInstructions('game7')"><img src="images/cover7.webp" onerror="this.src='images/cover7.png'" alt="7"><div class="game-label"><div class="g-title">7. Ø±Ø­Ù„Ø© Ø§Ù„Ù…ØªØ¹Ø© ğŸ²</div></div></div>
            <div class="game-item" onclick="openInstructions('game8')"><img src="images/cover8.webp" onerror="this.src='images/cover8.png'" alt="8"><div class="game-label"><div class="g-title">8. Ø¹Ø¬Ù„Ø© Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹ ğŸ¡</div></div></div>
            <div class="game-item full-width" onclick="openInstructions('game9')"><img src="images/cover9.webp" onerror="this.src='images/cover9.jpeg'" alt="9"><div class="game-label"><div class="g-title">9. Ø¯Ù„Ø¹ ÙˆÙˆÙ„Ø¹ ğŸ</div></div></div>
        </div>
    </div>

    <div id="gameplay" class="screen">
        <div class="top-nav"><button class="exit-btn" onclick="goHome()">âœ•</button><h2 id="g-header" class="nav-title"></h2><div class="dummy-space"></div></div>
        <div class="card-stage"><div class="flipper" id="card-obj"><div class="front"><div style="font-size:4rem; color:var(--primary);">?</div><p style="color:#666;">Ø§Ø¶ØºØ· Ù„Ù„ÙƒØ´Ù</p></div><div class="back"><div id="q-text" class="text-content"></div></div></div></div>
        <button class="btn-gold" style="width:200px; margin-top:30px;" onclick="flip()">Ø§Ø³Ø­Ø¨ ÙƒØ§Ø±Øª</button>
    </div>

    <div id="elimination-area" class="screen">
        <div class="top-nav"><button class="exit-btn" onclick="goHome()">âœ•</button><h2 class="nav-title" style="color:#ff9800;">Ø£Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø±ÙƒØ© âš”ï¸</h2><div class="dummy-space"></div></div>
        <div class="turn-banner" id="elim-turn">Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„Ù‰: Ø§Ù„Ø²ÙˆØ¬ ğŸ‘¨ (Ø§Ø­Ø°Ù Ù…ÙƒØ§Ù†)</div>
        <div class="elimination-grid" id="places-grid"></div>
        <button class="btn-gold" id="reset-elim-btn" style="display:none; margin-top:20px;" onclick="resetElimination()">Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© ğŸ”„</button>
    </div>

    <div id="scratch-area" class="screen" style="justify-content: center;">
        <div class="top-nav" style="margin-bottom: 30px;"><button class="exit-btn" onclick="goHome()">âœ•</button><h2 class="nav-title" style="color:var(--primary);">Ø®Ø±Ø¨Ø´ Ù‡Ø¯ÙŠØªÙƒ ğŸ</h2><div class="dummy-space"></div></div>
        <div style="position:relative; width:300px; height:150px; border:2px dashed var(--primary); border-radius:15px; overflow:hidden; background: #fff;">
            <div id="prize-txt" style="position:absolute; width:100%; height:100%; display:flex; justify-content:center; align-items:center; background:white; color:black; font-size:1.4rem; font-weight:bold; padding: 10px; text-align: center;"></div>
            <canvas id="cvs" style="position:absolute; top:0; left:0;"></canvas>
        </div>
        <button class="btn-gold" style="width:200px; margin-top:20px;" onclick="resetScratch()">Ø¬Ø§ÙŠØ²Ø© ØªØ§Ù†ÙŠØ©</button>
    </div>

    <div id="roleplay-area" class="screen">
        <div class="top-nav"><button class="exit-btn" onclick="goHome()">âœ•</button><h2 class="nav-title" style="color:var(--accent);">ğŸ­ ØªÙ…Ø«ÙŠÙ„ Ø³Ø§Ø®Ù†</h2><div class="dummy-space"></div></div>
        <p style="color:#aaa; font-size:0.9rem; margin-bottom:20px; text-align:center;">Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙŠÙ„Ø© Ù…Ø®ØªÙ„ÙØ©</p>
        <div class="rp-box">
            <div class="rp-label">Ø§Ù„Ø´Ø®ØµÙŠØ§Øª:</div><div id="rp-chars" class="rp-val"></div>
            <div class="rp-label">Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</div><div id="rp-wear" class="rp-val"></div>
            <div class="rp-label">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù‚ØµØ©:</div><div id="rp-plot" class="rp-val" style="border:none; font-size:1rem; line-height:1.5;"></div>
        </div>
        <button class="btn-gold" style="width:200px; margin-top:20px; background: linear-gradient(90deg, #e50914, #ff5050);" onclick="genRoleplay()">Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø¬Ø¯ÙŠØ¯ ğŸ¬</button>
    </div>

    <div id="catch-game-area" class="screen">
        <div class="top-nav"><button class="exit-btn" onclick="goHome()">âœ•</button><h2 class="nav-title" style="color:var(--blue);">Ø±Ø­Ù„Ø© Ø§Ù„Ù…ØªØ¹Ø© ğŸ²</h2><div class="dummy-space"></div></div>
        <div class="board-container" id="board"></div>
        <div class="catch-controls">
            <div style="text-align:center;"><div style="font-size:0.7rem; color:#aaa;">Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„Ù‰</div><div id="catch-player" style="font-weight:bold; color:var(--primary);">Ø§Ù„Ø²ÙˆØ¬ ğŸ‘¨</div></div>
            <button class="dice-btn" id="catch-dice" onclick="rollCatchDice()" ontouchstart="rollCatchDice()">ğŸ²</button>
            <div style="text-align:center;"><div style="font-size:0.7rem; color:#aaa;">Ø§Ù„Ù…ÙƒØ§Ù†</div><div id="catch-pos" style="font-weight:bold;">Start</div></div>
        </div>
        <button class="reset-btn" onclick="openConfirmModal()">ğŸ”„ Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯</button>
    </div>

    <div id="spin-game-area" class="screen">
        <div class="top-nav"><button class="exit-btn" onclick="goHome()">âœ•</button><h2 class="nav-title" style="color:var(--green);">Ø¹Ø¬Ù„Ø© Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹ ğŸ¡</h2><div class="dummy-space"></div></div>
        <div class="spin-header"><span style="color:#aaa; font-weight:bold;">Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„Ù‰:</span><span id="spin-player" style="color:var(--green); font-weight:900;">Ø§Ù„Ø²ÙˆØ¬ ğŸ‘¨</span></div>
        <div style="position:relative; margin-top: 20px;"><div class="pointer"></div><div class="wheel-container"><div class="wheel-bg" id="wheel-bg"></div><div class="wheel-icons-layer" id="wheel-icons"></div></div></div>
        <button class="btn-gold" style="width:200px; margin-top:40px; background: linear-gradient(90deg, #2ecc71, #27ae60);" onclick="spinWheel()">Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø© ğŸ’«</button>
    </div>

    <div id="instructions-screen" class="modal-glass">
        <div class="instr-content">
            <div id="instr-title" class="instr-title"></div><div id="instr-body" class="instr-body"></div>
            <button class="btn-gold" id="instr-start-btn">ÙŠÙ„Ø§ Ù†Ø¨Ø¯Ø£ ğŸš€</button>
            <button style="background:none; border:none; color:#888; margin-top:15px; width:100%; cursor:pointer;" onclick="document.getElementById('instructions-screen').classList.remove('show')">Ø±Ø¬ÙˆØ¹</button>
        </div>
    </div>
    <div id="wheel-modal" class="modal-glass"><div class="wheel-result-card"><div id="wheel-result-icon" style="font-size:4rem; margin-bottom:5px;"></div><h2 id="wheel-result-title" style="color:var(--green); margin:0; font-weight:900; font-size:1.6rem;"></h2><p id="wheel-result-desc"></p><button class="btn-gold" onclick="closeWheelModal()">Ù†ÙØ°Ù†Ø§ Ø§Ù„Ø£Ù…Ø± ğŸ˜‰</button></div></div>
    <div id="catch-modal" class="modal-glass"><div class="catch-card" id="catch-card-content"></div></div>
    <div id="confirm-modal" class="modal-glass"><div class="instr-content" style="text-align:center; max-width:300px;"><div class="instr-title" style="color:var(--accent); border:none; margin-bottom:5px;">âš ï¸ ØªÙ†Ø¨ÙŠÙ‡</div><p style="color:#ddd; margin-bottom:25px; font-size:1rem;">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ<br>Ù‡ÙŠØªÙ… Ù…Ø³Ø­ Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØ§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ù†Ù‚Ø·Ø© Ø§Ù„ØµÙØ±!</p><div style="display:flex; gap:10px; justify-content:center;"><button class="btn-gold" style="background:var(--accent); color:white; width:100px;" onclick="executeReset()">Ù†Ø¹Ù…</button><button class="btn-gold" style="background:#333; color:#ccc; width:100px;" onclick="closeConfirmModal()">Ù„Ø§</button></div></div></div>

    <script>
    // ==========================================
    // 1. SYSTEM CONFIGURATION & API (The Brain)
    // ==========================================
    
    // âš ï¸ğŸ”´ PUT YOUR GOOGLE SCRIPT URL HERE ğŸ”´âš ï¸
    const API_URL = "https://script.google.com/macros/s/AKfycbw1dfXB3nmiubr8Z5QQV5uRPfXgGgUl32bLDPZ3EsEAg52WrYnlriawZb426XeNqDsq/exec"; 
    
    let fpPromise = FingerprintJS.load();

    // Security
    document.addEventListener('contextmenu', event => event.preventDefault());
    document.onkeydown = function(e) { if(e.keyCode == 123 || (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) || (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0))) return false; }

    function show(id, withSound = true) {
        if(withSound) try{ playSound('click'); }catch(e){}
        document.querySelectorAll('.screen').forEach(s => { 
            if(s.id !== id) { s.classList.remove('active'); setTimeout(()=> { if(!s.classList.contains('active')) s.style.display='none'; }, 300); }
        });
        const el = document.getElementById(id);
        if(el) { el.style.display = 'flex'; setTimeout(()=>el.classList.add('active'), 10); }
    }

    function openRegister(plan) {
        document.getElementById('reg-plan').value = plan;
        document.getElementById('register-modal').style.display = 'flex';
        setTimeout(()=>document.getElementById('register-modal').classList.add('show'), 10);
    }

    function submitRegistration() {
        const name = document.getElementById('reg-name').value;
        const phone = document.getElementById('reg-phone').value;
        const plan = document.getElementById('reg-plan').value;
        const btn = document.getElementById('reg-btn');
        if(!name || !phone) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø¬Ø²..."; btn.disabled = true;

        fetch(API_URL, {
            method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ action: "register", name: name, phone: phone, plan: plan })
        }).then(() => {
            document.getElementById('register-modal').classList.remove('show');
            document.getElementById('register-modal').style.display = 'none';
            showSuccessModal(name, phone, plan);
            btn.innerText = "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨"; btn.disabled = false;
        }).catch(err => { alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"); btn.disabled = false; });
    }

    function showSuccessModal(name, phone, plan) {
        const myNumber = "201017854522"; // âš ï¸ YOUR WHATSAPP
        const displayNumber = "01017854522"; // âš ï¸ DISPLAY NUMBER
        const msgText = `Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£Ù†Ø§ ${name}.%0aØ±Ù‚Ù…ÙŠ: ${phone}%0aØªÙ… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø¨Ø§Ù‚Ø© (${plan} Ø´Ù‡Ø±).%0aØ¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¢Ù†..`;
        const waLink = `https://wa.me/${myNumber}?text=${msgText}`;
        const modal = document.getElementById('modal-guide'); 
        modal.innerHTML = `
            <div class="login-card-pro" style="animation:none;">
                <h2 style="color:var(--green); margin-top:0;">ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨! âœ…</h2>
                <p style="color:#ddd;">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ <b>${name}</b></p>
                <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:10px; margin:15px 0;">
                    <p style="margin:0; color:#aaa; font-size:0.8rem;">1. Ø­ÙˆÙ„ Ø§Ù„Ù…Ø¨Ù„Øº ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø¹Ù„Ù‰:</p>
                    <h2 style="color:var(--primary); margin:5px 0;">${displayNumber}</h2>
                </div>
                <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:10px; margin-bottom:20px;">
                    <p style="margin:0; color:#aaa; font-size:0.8rem;">2. Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯:</p>
                    <a href="${waLink}" target="_blank" style="text-decoration:none;">
                        <button class="btn-gold" style="background: #25D366; color: white; border:none; margin-top:10px;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹ ÙˆØ§ØªØ³Ø§Ø¨ ğŸ’¬</button>
                    </a>
                </div>
                <button style="background:none; border:none; color:#666; margin-top:10px;" onclick="location.reload()">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>`;
        modal.classList.add('show');
    }

    async function login() {
        const code = document.getElementById('pass').value;
        const btn = document.querySelector('#login .btn-pro');
        const errorMsg = document.getElementById('error');
        if(!code) return;
        btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚..."; btn.disabled = true; errorMsg.style.display = 'none';
        try {
            const fp = await fpPromise; const result = await fp.get(); const fingerprint = result.visitorId;
            const response = await fetch(API_URL, {
                redirect: "follow", method: 'POST', headers: { "Content-Type": "text/plain;charset=utf-8" },
                body: JSON.stringify({ action: "login", code: code, fingerprint: fingerprint })
            });
            const data = await response.json();
            if(data.success) {
                localStorage.setItem('hn_code', code); // Important for auto-login
                localStorage.setItem('hn_token', data.token);
                if (audioCtx.state === 'suspended') audioCtx.resume();
                show('dashboard');
            } else { errorMsg.innerText = "âš ï¸ " + data.msg; errorMsg.style.display = 'block'; }
        } catch(e) { errorMsg.innerText = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±"; errorMsg.style.display = 'block'; }
        finally { btn.innerText = "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø³Ù‡Ø±Ø© ğŸš€"; btn.disabled = false; }
    }

    // Startup Logic (Real-Time Check)
    window.onload = async function() {
        const savedCode = localStorage.getItem('hn_code');
        if(savedCode) {
            try {
                const loadingOverlay = document.createElement('div');
                loadingOverlay.style = "position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:9999;display:flex;justify-content:center;align-items:center;color:var(--primary);font-family:'Cairo';";
                loadingOverlay.innerHTML = "Ø¬Ø§Ø±ÙŠ ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø§ØªØµØ§Ù„... ğŸ”’";
                document.body.appendChild(loadingOverlay);
                
                const fp = await fpPromise; const result = await fp.get(); const fingerprint = result.visitorId;
                const response = await fetch(API_URL, {
                    redirect: "follow", method: 'POST', headers: { "Content-Type": "text/plain;charset=utf-8" },
                    body: JSON.stringify({ action: "login", code: savedCode, fingerprint: fingerprint })
                });
                const data = await response.json();
                loadingOverlay.remove();

                if(data.success) { show('dashboard', false); } 
                else { alert("ØªÙ†Ø¨ÙŠÙ‡ Ø£Ù…Ù†ÙŠ: " + data.msg); logoutAndKick(); }
            } catch (error) { alert("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ù„ØªØ­Ù‚Ù‚."); logoutAndKick(); }
        } else {
            const landing = document.getElementById('landing');
            if(landing) landing.style.display = 'flex'; else show('login', false); 
        }
        
        // Load Game Data
        setTimeout(() => {
            const savedP1 = localStorage.getItem('hn_catch_p1');
            const savedP2 = localStorage.getItem('hn_catch_p2');
            const savedTurn = localStorage.getItem('hn_catch_turn');
            if(typeof catchPlayers !== 'undefined') {
                if(savedP1) catchPlayers[0].pos = parseInt(savedP1);
                if(savedP2) catchPlayers[1].pos = parseInt(savedP2);
                if(savedTurn) cTurn = parseInt(savedTurn);
            }
        }, 500);
    };

    function logoutAndKick() {
        localStorage.clear(); location.reload();
    }

    // ==========================================
    // 2. GAME ENGINE & DATA
    // ==========================================
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(type) { if (audioCtx.state === 'suspended') audioCtx.resume(); /* (Sound logic here is fine in original, kept simple) */ }

    // (Ø£Ù†Øª ØªØ­ØªØ§Ø¬ Ù„Ù†Ø³Ø® Ù…ØµÙÙˆÙØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª db Ùˆ catchDB Ùˆ placesData Ùˆ wheelSegments Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§ Ù…Ù† ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø³Ø§Ø¨Ù‚)
    // Ø³Ø£Ø¶Ø¹ Ù‡Ù†Ø§ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø© ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù„ÙŠÙƒÙˆÙ† Ø§Ù„ÙƒÙˆØ¯ Ø¬Ø§Ù‡Ø²Ø§Ù‹
    
    // --- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© (300+ Ø³Ø¤Ø§Ù„) ---
    const db = {
        stage1: [
            { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ Ø¨ÙŠØµØ±Ù ÙÙ„ÙˆØ³ Ø£ÙƒØªØ± Ø¹Ù„Ù‰ Ø­Ø§Ø¬Ø§Øª ØªØ§ÙÙ‡Ø©ØŸ" }, { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ Ø¨ÙŠØ´Ø®Ø± ÙˆÙ‡Ùˆ Ù†Ø§ÙŠÙ…ØŸ" }, { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ Ø¨ÙŠØ³ØªØ­Ù…Ù‰ ÙˆÙ‚Øª Ø£Ø·ÙˆÙ„ØŸ" }, { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ Ø·Ø¨Ø®Ù‡ Ø£Ø­Ù„Ù‰ØŸ" }, { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ Ø¹ØµØ¨ÙŠ Ø£ÙƒØªØ±ØŸ" },
            { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ Ø¨ÙŠØµØ§Ù„Ø­ Ø§Ù„ØªØ§Ù†ÙŠ Ø§Ù„Ø£ÙˆÙ„ Ù„Ù…Ø§ Ù†ØªØ®Ø§Ù†Ù‚ØŸ" }, { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ Ø¨ÙŠØ­Ø¨ ÙŠØ®Ø±Ø¬ Ø£ÙƒØªØ±ØŸ" }, { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ ÙƒØ³ÙˆÙ„ Ø£ÙƒØªØ± ÙŠÙˆÙ… Ø§Ù„Ø¬Ù…Ø¹Ø©ØŸ" }, { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ Ø¨ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø£ÙƒØªØ±ØŸ" }, { t: "b", q: "Ù…ÙŠÙ† ÙÙŠÙ†Ø§ ØµÙˆØªÙ‡ Ø£ÙˆØ­Ø´ ÙÙŠ Ø§Ù„ØºÙ†Ø§ØŸ" },
            { t: "m", q: "Ù‚Ù„Ø¯ ØµÙˆØª Ø­Ù…Ø§ØªÙƒ ÙˆÙ‡ÙŠ Ø¨ØªØ´ØªÙƒÙŠ." }, { t: "m", q: "Ù‚Ù„Ø¯ Ø·Ø±ÙŠÙ‚Ø© Ù…Ø±Ø§ØªÙƒ Ù„Ù…Ø§ ØªÙƒÙˆÙ† ØºÙŠØ±Ø§Ù†Ø©." }, { t: "m", q: "Ø§Ø¹Ù…Ù„ Ù†ÙØ³Ùƒ Ù‚Ø±Ø¯ ÙˆØªÙ†Ø·Ø· Ù„Ù…Ø¯Ø© 10 Ø«ÙˆØ§Ù†ÙŠ." }, { t: "f", q: "Ù‚Ù„Ø¯ÙŠ Ø·Ø±ÙŠÙ‚Ø© Ø¬ÙˆØ²Ùƒ Ù„Ù…Ø§ ÙŠØ±Ø¬Ø¹ Ù…Ù† Ø§Ù„Ø´ØºÙ„ ØªØ¹Ø¨Ø§Ù†." }, { t: "f", q: "Ù‚Ù„Ø¯ÙŠ Ø·Ø±ÙŠÙ‚Ø© Ø¬ÙˆØ²Ùƒ ÙˆÙ‡Ùˆ Ø¨ÙŠØªÙØ±Ø¬ Ø¹Ù„Ù‰ Ù…Ø§ØªØ´." },
            { t: "f", q: "Ø§Ø±Ù‚ØµÙŠ Ø¨Ù„Ø¯ÙŠ Ù„Ù…Ø¯Ø© 30 Ø«Ø§Ù†ÙŠØ© Ø¨Ø¯ÙˆÙ† Ù…ÙˆØ³ÙŠÙ‚Ù‰." }
            // ... (Ø£ÙƒÙ…Ù„ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù€ 300 Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§ØŒ Ø§Ù„ÙƒÙˆØ¯ Ø³ÙŠØ³ØªÙˆØ¹Ø¨Ù‡Ø§)
        ],
        stage2: [ { t: "b", q: "Ø£ÙˆÙ„ Ø§Ù†Ø·Ø¨Ø§Ø¹ Ø®Ø¯ØªÙ‡ Ø¹Ù† Ø§Ù„Ø·Ø±Ù Ø§Ù„ØªØ§Ù†ÙŠØŸ" }, { t: "b", q: "Ø£ÙƒØªØ± Ù…ÙˆÙ‚Ù Ù…Ø­Ø±Ø¬ Ø­ØµÙ„Ù†Ø§ Ø³ÙˆØ§ØŸ" }, { t: "b", q: "ØªØ§Ø±ÙŠØ® Ø£ÙˆÙ„ Ù…Ø±Ø© ØªÙ‚Ø§Ø¨Ù„Ù†Ø§ ÙÙŠÙ‡Ø§ØŸ" } ],
        stage3: [ { t: "m", q: "Ø¨ÙˆØ³Ø© Ø·ÙˆÙŠÙ„Ø© ÙˆØ¹Ù…ÙŠÙ‚Ø© Ø¹Ù„Ù‰ Ø±Ù‚Ø¨Ø© Ù…Ø±Ø§ØªÙƒ." }, { t: "f", q: "Ø¨ÙˆØ³ÙŠ Ø±Ù‚Ø¨Ø© Ø¬ÙˆØ²Ùƒ Ø¨Ø¨Ø·Ø¡ Ø´Ø¯ÙŠØ¯." }, { t: "b", q: "Ø¨ÙˆØ³Ø© ÙØ±Ù†Ø³ÙŠØ© (French Kiss) Ù„Ù…Ø¯Ø© 10 Ø«ÙˆØ§Ù†ÙŠ." } ],
        stage4: [ { t: "b", q: "ÙˆØ¶Ø¹ 'Ø§Ù„Ø¯ÙˆØ¬ÙŠ' (Doggy)." }, { t: "b", q: "ÙˆØ¶Ø¹ 'Ø§Ù„ÙØ§Ø±Ø³Ø©' (Cowgirl)." }, { t: "b", q: "ÙˆØ¶Ø¹ 'Ø§Ù„Ù…Ø¨Ø´Ø±' (Missionary)." } ],
        prizes: [ "Ù…Ø³Ø§Ø¬ Ù„Ù„Ø±Ø¬Ù„ÙŠÙ† (Foot Massage).", "ÙØ·Ø§Ø± ÙÙŠ Ø§Ù„Ø³Ø±ÙŠØ±.", "Ø¥Ø¹ÙØ§Ø¡ Ù…Ù† Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠÙ†.", "Ø±Ù‚ØµØ© Ø®Ø§ØµØ©." ],
        roleplays: [ { chars: "Ø§Ù„Ø¯ÙƒØªÙˆØ± ÙˆØ§Ù„Ù…Ø±ÙŠØ¶Ø©", wear: "Ø¨Ø§Ù„Ø·Ùˆ / Ù„Ø§Ù†Ø¬Ø±ÙŠ", plot: "ÙƒØ´Ù Ø´Ø§Ù…Ù„..." }, { chars: "Ø§Ù„Ø³ÙƒØ±ØªÙŠØ±Ø© ÙˆØ§Ù„Ù…Ø¯ÙŠØ±", wear: "Ø±Ø³Ù…ÙŠ / Ù‚ØµÙŠØ±", plot: "Ø¹Ù‚Ø§Ø¨ Ù„Ù„ØªØ£Ø®ÙŠØ±..." } ]
    };

    const catchDB = [
        { type: "start", text: "Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©", icon: "ğŸ", desc: "ÙŠÙ„Ø§ Ø¨ÙŠÙ†Ø§!" },
        { type: "blue", text: "Ø¨ÙˆØ³Ø©", desc: "Ø¨ÙˆØ³Ø© Ø±Ù‚ÙŠÙ‚Ø©.", icon: "ğŸ’‹" },
        { type: "purple", text: "Ø¹Ø¶", desc: "Ø¹Ø¶Ø© Ø®ÙÙŠÙØ©.", icon: "ğŸ§›" },
        { type: "pink", text: "Ù…Ø³Ø§Ø¬", desc: "Ù…Ø³Ø§Ø¬ Ù„Ù„Ø±Ù‚Ø¨Ø©.", icon: "ğŸ’†" },
        { type: "red", text: "Ù†Ø§Ø±", desc: "ÙˆØ¶Ø¹ Ø¬Ø±ÙŠØ¡.", icon: "ğŸ”¥" },
        { type: "finish", text: "Ø§Ù„Ù†Ù‡Ø§ÙŠØ©", desc: "Ù…Ø¨Ø±ÙˆÙƒ!", icon: "ğŸ‰" }
    ];

    const placesData = [
        { id: 1, name: "Ø§Ù„Ø³Ø±ÙŠØ±", icon: "ğŸ›ï¸" }, { id: 2, name: "Ø§Ù„ÙƒÙ†Ø¨Ø©", icon: "ğŸ›‹ï¸" }, { id: 3, name: "Ø§Ù„Ø£Ø±Ø¶", icon: "ğŸ§˜" },
        { id: 4, name: "Ø§Ù„Ù…Ø·Ø¨Ø®", icon: "ğŸ”ª" }, { id: 5, name: "Ø§Ù„Ø³ÙØ±Ø©", icon: "ğŸ½ï¸" }, { id: 6, name: "Ø§Ù„Ø¯Ø´", icon: "ğŸš¿" },
        { id: 7, name: "Ø§Ù„Ø¨Ø§Ù†ÙŠÙˆ", icon: "ğŸ›" }, { id: 8, name: "Ø§Ù„ØºØ³Ø§Ù„Ø©", icon: "ğŸ§º" }, { id: 9, name: "Ø§Ù„ÙƒØ±Ø³ÙŠ", icon: "ğŸª‘" }
    ];

    const wheelSegments = [
        { text: "Doggy", icon: "ğŸ•", color: "#e74c3c", desc: "ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø·Ø©..." },
        { text: "Oral", icon: "ğŸ­", color: "#e67e22", desc: "Ø§Ø³ØªØ®Ø¯Ù… ÙÙ…Ùƒ..." },
        { text: "Cowgirl", icon: "ğŸ¤ ", color: "#f1c40f", desc: "Ø§Ù„Ø²ÙˆØ¬Ø© ÙÙˆÙ‚..." },
        { text: "Missionary", icon: "ğŸ›Œ", color: "#cddc39", desc: "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ..." },
        { text: "69", icon: "â™‹", color: "#1abc9c", desc: "ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ù…ØªØ¹Ø©..." },
        { text: "Spoon", icon: "ğŸ¥„", color: "#3498db", desc: "Ù†Ø§ÙŠÙ…ÙŠÙ† Ø¹Ù„Ù‰ Ø¬Ù†Ø¨..." }
    ];

    // --- Helper Functions ---
    function shuffleArray(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } return array; }
    function goHome() { show('dashboard'); }
    function openGuide() { try{playSound('click');}catch(e){} document.getElementById('modal-guide').classList.add('show'); }
    function closeGuide() { try{playSound('click');}catch(e){} document.getElementById('modal-guide').classList.remove('show'); }

    function openInstructions(gameId) {
        try{playSound('click');}catch(e){}
        const data = gameInstructions[gameId];
        if(!data) return;
        document.getElementById('instr-title').innerText = data.title;
        document.getElementById('instr-body').innerHTML = data.content;
        document.getElementById('instr-start-btn').onclick = () => { document.getElementById('instructions-screen').classList.remove('show'); data.action(); };
        document.getElementById('instructions-screen').classList.add('show');
    }

    function startGame(stg) {
        activeStage = stg;
        // If data isn't loaded fully, fallback to sample
        const list = db[stg] && db[stg].length > 0 ? db[stg] : [{t:'b', q:'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©...'}];
        currentQ = shuffleArray([...list]); 
        let title = "";
        if(stg=='stage1') title="1. Ù‡Ø²Ø§Ø± ÙˆÙ†Ø§Ø± ğŸ˜‚"; if(stg=='stage2') title="2. Ø­Ø¨ ÙˆÙ‚Ø±Ø¨ â¤ï¸";
        if(stg=='stage3') title="4. Ù‡Ù…Ø³ ÙˆÙ„Ù…Ø³ ğŸ”¥"; if(stg=='stage4') title="5. Ù†Ø§Ø± ÙˆØ¯Ù…Ø§Ø± ğŸ”";
        document.getElementById('g-header').innerText = title;
        document.getElementById('card-obj').classList.remove('flipped');
        show('gameplay');
    }

    function flip() {
        try{playSound('click');}catch(e){}
        const c = document.getElementById('card-obj');
        if(c.classList.contains('flipped')) { c.classList.remove('flipped'); setTimeout(updTxt, 300); }
        else { updTxt(); c.classList.add('flipped'); }
    }

    function updTxt() {
        if(!db[activeStage]) return;
        if(currentQ.length===0) currentQ = shuffleArray([...db[activeStage]]);
        const item = currentQ.pop();
        const textDiv = document.getElementById('q-text');
        let roleHtml = item.t === 'm' ? "<div style='color:#00a8ff; font-size:1rem; margin-bottom:10px;'>ğŸ‘¨ Ø¯ÙˆØ± Ø§Ù„Ø²ÙˆØ¬</div>" : (item.t === 'f' ? "<div style='color:#ff007f; font-size:1rem; margin-bottom:10px;'>ğŸ‘© Ø¯ÙˆØ± Ø§Ù„Ø²ÙˆØ¬Ø©</div>" : "<div style='color:#d4af37; font-size:1rem; margin-bottom:10px;'>ğŸ‘« Ù„ÙŠÙƒÙ… Ø³ÙˆØ§</div>");
        textDiv.innerHTML = roleHtml + item.q;
    }

    // Roleplay Logic
    function genRoleplay() {
        try{playSound('click');}catch(e){}
        const list = db.roleplays || [{chars:'--', wear:'--', plot:'--'}];
        const rp = list[Math.floor(Math.random() * list.length)];
        document.getElementById('rp-chars').innerText = rp.chars;
        document.getElementById('rp-wear').innerText = rp.wear;
        document.getElementById('rp-plot').innerText = rp.plot;
    }

    // Scratch Logic
    function resetScratch() {
        cvs = document.getElementById('cvs'); ctx = cvs.getContext('2d');
        const p = cvs.parentElement; cvs.width = p.offsetWidth; cvs.height = p.offsetHeight;
        const list = db.prizes || ["Ø¬Ø§Ø¦Ø²Ø©"];
        document.getElementById('prize-txt').innerText = list[Math.floor(Math.random()*list.length)];
        ctx.globalCompositeOperation='source-over'; ctx.fillStyle='#bbb'; ctx.fillRect(0,0,cvs.width,cvs.height);
        ctx.fillStyle='#fff'; ctx.font='bold 20px Cairo'; ctx.textAlign='center'; ctx.fillText("Ø§Ø®Ø±Ø¨Ø´ Ù‡Ù†Ø§", cvs.width/2, cvs.height/2+8);
        ctx.globalCompositeOperation='destination-out';
    }

    // Elimination Logic
    let activePlacesCount = 9; let elimTurn = 0;
    function startEliminationGame() { show('elimination-area'); resetElimination(); }
    function resetElimination() {
        const grid = document.getElementById('places-grid'); grid.innerHTML = "";
        activePlacesCount = placesData.length; elimTurn = Math.floor(Math.random() * 2); updateElimTurnUI();
        document.getElementById('reset-elim-btn').style.display = 'none';
        placesData.forEach(p => {
            const card = document.createElement('div'); card.className = 'place-card'; card.id = `p-${p.id}`;
            card.onclick = () => eliminatePlace(p.id);
            card.innerHTML = `<div class="place-icon">${p.icon}</div><div class="place-name">${p.name}</div>`;
            grid.appendChild(card);
        });
    }
    function eliminatePlace(id) {
        if (activePlacesCount <= 1) return;
        const card = document.getElementById(`p-${id}`); if (card.classList.contains('eliminated')) return;
        try{playSound('click');}catch(e){}
        card.classList.add('eliminated'); activePlacesCount--; elimTurn = (elimTurn === 0) ? 1 : 0; updateElimTurnUI();
        if (activePlacesCount === 1) { 
            const winner = document.querySelector('.place-card:not(.eliminated)'); 
            if(winner) winner.classList.add('winner'); 
            document.getElementById('elim-turn').innerText = `ğŸ‰ Ø§Ù„ÙØ§Ø¦Ø²: ${winner.querySelector('.place-name').innerText}`; 
            document.getElementById('reset-elim-btn').style.display = 'block';
            try{playSound('win');}catch(e){}
        }
    }
    function updateElimTurnUI() {
        const banner = document.getElementById('elim-turn');
        if (elimTurn === 0) { banner.innerText = "Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„Ù‰: Ø§Ù„Ø²ÙˆØ¬ ğŸ‘¨ (Ø§Ø­Ø°Ù Ù…ÙƒØ§Ù†)"; banner.style.color = "#00bfff"; banner.style.borderColor = "#00bfff"; }
        else { banner.innerText = "Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„Ù‰: Ø§Ù„Ø²ÙˆØ¬Ø© ğŸ‘© (Ø§Ø­Ø°ÙÙŠ Ù…ÙƒØ§Ù†)"; banner.style.color = "#ff007f"; banner.style.borderColor = "#ff007f"; }
    }

    // Catch Me Logic
    const catchPlayers = [ { name: "Ø§Ù„Ø²ÙˆØ¬", icon: "ğŸ‘¨", pos: 0, css: "p1-token" }, { name: "Ø§Ù„Ø²ÙˆØ¬Ø©", icon: "ğŸ‘©", pos: 0, css: "p2-token" } ];
    let cTurn = 0; let boardCreated = false;
    function startCatchMe() { show('catch-game-area'); if(!boardCreated) { createCatchBoard(); boardCreated = true; } }
    function createCatchBoard() {
        const board = document.getElementById('board'); board.innerHTML = "";
        let row = document.createElement('div'); row.className = 'row';
        for (let i = 50; i >= 0; i--) {
            let z = ''; if(i===0||i===50) z='finish-zone'; else if(i<=12) z='blue-zone'; else if(i<=25) z='purple-zone'; else if(i<=37) z='pink-zone'; else z='red-zone';
            const sq = document.createElement('div'); sq.className = `square ${z}`; sq.id = `sq-${i}`; sq.innerHTML = i===0 ? "Start" : i;
            row.appendChild(sq);
            if((50-i+1)%5===0 || i===0) { board.appendChild(row); row = document.createElement('div'); row.className = 'row'; }
        }
        updateTokens();
    }
    function updateTokens() {
        document.querySelectorAll('.player-token').forEach(e=>e.remove());
        catchPlayers.forEach(p => { const sq = document.getElementById(`sq-${p.pos}`); if(sq) { const t = document.createElement('div'); t.className = `player-token ${p.css}`; sq.appendChild(t); } });
    }
    function rollCatchDice() {
        try{playSound('dice');}catch(e){}
        const btn = document.getElementById('catch-dice'); if(btn.classList.contains('rolling')) return;
        btn.innerText = "ğŸ²"; btn.classList.add('rolling');
        setTimeout(() => {
            const r = Math.floor(Math.random()*6)+1; btn.innerText = r; btn.classList.remove('rolling');
            moveCatchPlayer(r);
        }, 600);
    }
    function moveCatchPlayer(steps) {
        const p = catchPlayers[cTurn]; let moved = 0;
        const intv = setInterval(() => {
            if(p.pos < 50) { p.pos++; updateTokens(); moved++; localStorage.setItem('hn_catch_p1', catchPlayers[0].pos); localStorage.setItem('hn_catch_p2', catchPlayers[1].pos); }
            if(moved >= steps || p.pos >= 50) { clearInterval(intv); setTimeout(()=>showCatchChallenge(p.pos), 500); }
        }, 300);
    }
    function showCatchChallenge(pos) {
        try{playSound('win');}catch(e){}
        if(pos === 0) { switchCTurn(); return; }
        const data = catchDB[pos] || catchDB[catchDB.length-1];
        const modal = document.getElementById('catch-modal'); const content = document.getElementById('catch-card-content');
        let color = 'var(--primary)'; if(data.type === 'blue') color = 'var(--blue)'; if(data.type === 'purple') color = 'var(--purple)'; if(data.type === 'pink') color = '#ff00cc'; if(data.type === 'red') color = 'var(--accent)';
        content.style.borderColor = color;
        content.innerHTML = `<div class="catch-icon">${data.icon}</div><div class="catch-title" style="color:${color}">${data.text}</div><div class="catch-desc">${data.desc}</div><button class="btn-gold" style="background:${color}; border:none;" onclick="closeCatchModal()">Ù†ÙØ°Ù†Ø§ ğŸ˜‰</button>`;
        modal.style.display = 'flex';
    }
    function closeCatchModal() {
        try{playSound('click');}catch(e){}
        document.getElementById('catch-modal').style.display = 'none';
        if(catchPlayers[cTurn].pos >= 50) { 
            alert(`Ù…Ø¨Ø±ÙˆÙƒ! ${catchPlayers[cTurn].name} ÙƒØ³Ø¨ Ø§Ù„Ù„ÙŠÙ„Ø©! ğŸ‰`); 
            catchPlayers[0].pos=0; catchPlayers[1].pos=0; localStorage.removeItem('hn_catch_p1'); localStorage.removeItem('hn_catch_p2'); localStorage.removeItem('hn_catch_turn'); updateTokens(); cTurn=0; 
        } else { switchCTurn(); }
    }
    function switchCTurn() { cTurn = (cTurn === 0) ? 1 : 0; localStorage.setItem('hn_catch_turn', cTurn); const p = catchPlayers[cTurn]; document.getElementById('catch-player').innerText = `${p.name} ${p.icon}`; document.getElementById('catch-pos').innerText = p.pos===0?"Start":p.pos; }

    // Spin Wheel Logic
    let wheelCreated = false; let currentRotation = 0; let spinTurn = 0;
    const spinPlayers = [ { name: "Ø§Ù„Ø²ÙˆØ¬", icon: "ğŸ‘¨" }, { name: "Ø§Ù„Ø²ÙˆØ¬Ø©", icon: "ğŸ‘©" } ];
    function startSpinGame() { show('spin-game-area'); if (!wheelCreated) { createWheelClean(); wheelCreated = true; } updateSpinUI(); }
    function updateSpinUI() { const p = spinPlayers[spinTurn]; document.getElementById('spin-player').innerText = `${p.name} ${p.icon}`; }
    function createWheelClean() {
        let gradientString = "conic-gradient("; const segmentSize = 360 / wheelSegments.length;
        wheelSegments.forEach((seg, i) => { const startDeg = i * segmentSize; const endDeg = (i + 1) * segmentSize; gradientString += `${seg.color} ${startDeg}deg ${endDeg}deg${i < wheelSegments.length - 1 ? ',' : ''}`; });
        gradientString += ")"; document.getElementById('wheel-bg').style.background = gradientString;
        const iconContainer = document.getElementById('wheel-icons');
        wheelSegments.forEach((seg, i) => {
            const box = document.createElement('div'); box.className = 'icon-box';
            const midAngle = (i * segmentSize) + (segmentSize / 2);
            box.style.transform = `rotate(${midAngle}deg)`;
            box.innerHTML = `<div class="icon-content" style="transform: rotate(90deg);">${seg.icon}</div>`;
            iconContainer.appendChild(box);
        });
    }
    function spinWheel() {
        const bg = document.getElementById('wheel-bg'); const icons = document.getElementById('wheel-icons');
        const spinBtn = document.querySelector('#spin-game-area .btn-gold'); if(spinBtn.disabled) return;
        let tickInterval = setInterval(() => { try{playSound('tick');}catch(e){} }, 200);
        spinBtn.disabled = true; const randomDeg = Math.floor(1800 + Math.random() * 1800); currentRotation += randomDeg;
        bg.style.transform = `rotate(${currentRotation}deg)`; icons.style.transform = `rotate(${currentRotation}deg)`;
        setTimeout(() => { clearInterval(tickInterval); }, 4000);
        setTimeout(() => {
            const numSegments = wheelSegments.length; const segAngle = 360 / numSegments;
            const actualDeg = currentRotation % 360; const winningAngle = (360 - actualDeg) % 360;
            const winningIndex = Math.floor(winningAngle / segAngle);
            showWheelResult(wheelSegments[winningIndex]); spinBtn.disabled = false;
        }, 4000);
    }
    function showWheelResult(res) {
        try{playSound('win');}catch(e){}
        const modal = document.getElementById('wheel-modal'); document.getElementById('wheel-result-icon').innerText = res.icon; document.getElementById('wheel-result-title').innerText = res.text; document.getElementById('wheel-result-desc').innerText = res.desc; modal.style.display = 'flex';
    }
    function closeWheelModal() {
        try{playSound('click');}catch(e){}
        document.getElementById('wheel-modal').style.display = 'none'; spinTurn = (spinTurn === 0) ? 1 : 0; updateSpinUI();
    }
    function openConfirmModal() { try{playSound('click');}catch(e){} const modal = document.getElementById('confirm-modal'); if(modal) { modal.style.display = 'flex'; setTimeout(() => modal.classList.add('show'), 10); } }
    function closeConfirmModal() { try{playSound('click');}catch(e){} const modal = document.getElementById('confirm-modal'); if(modal) { modal.classList.remove('show'); setTimeout(() => modal.style.display = 'none', 300); } }
    function executeReset() {
        try{playSound('click');}catch(e){}
        catchPlayers[0].pos = 0; catchPlayers[1].pos = 0; cTurn = 0;
        localStorage.removeItem('hn_catch_p1'); localStorage.removeItem('hn_catch_p2'); localStorage.removeItem('hn_catch_turn');
        updateTokens(); document.getElementById('catch-player').innerText = `${catchPlayers[0].name} ${catchPlayers[0].icon}`; document.getElementById('catch-pos').innerText = "Start";
        closeConfirmModal(); if(navigator.vibrate) navigator.vibrate(200);
    }
    </script>
</body>
</html>
